<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication Test</title>
</head>
<body>
    <h1>Authentication Test</h1>
    <button onclick="testAuth()">Test Demo Users</button>
    <button onclick="clearStorage()">Clear Storage</button>
    <div id="output"></div>

    <script>
        // Demo users data
        const demoUsers = [
            {
                id: 'demo-user-1',
                username: 'System Administrator',
                email: 'admin@company.com',
                password: 'Admin@123',
                role: 'admin',
                department: 'IT',
                employee_id: 'EMP001',
                is_active: true,
                created_at: new Date().toISOString(),
            },
            {
                id: 'demo-user-2',
                username: 'Inventory Manager',
                email: 'inventory@company.com',
                password: 'Inventory@123',
                role: 'inventory_manager',
                department: 'IT',
                employee_id: 'EMP002',
                is_active: true,
                created_at: new Date().toISOString(),
            },
            {
                id: 'demo-user-3',
                username: 'John Employee',
                email: 'employee@company.com',
                password: 'Employee@123',
                role: 'employee',
                department: 'IT',
                employee_id: 'EMP003',
                is_active: true,
                created_at: new Date().toISOString(),
            },
            {
                id: 'demo-user-4',
                username: 'Audit Manager',
                email: 'auditor@company.com',
                password: 'Auditor@123',
                role: 'auditor',
                department: 'Audit',
                employee_id: 'EMP004',
                is_active: true,
                created_at: new Date().toISOString(),
            },
        ];

        function initializeDemoData() {
            localStorage.setItem('demo_users', JSON.stringify(demoUsers));
            console.log('Demo users initialized/refreshed:', demoUsers.length, 'users');
            
            demoUsers.forEach((user, index) => {
                console.log(`Demo user ${index + 1}:`, user.email, '-', user.role);
            });
        }

        function testAuth() {
            const output = document.getElementById('output');
            
            // Initialize demo data
            initializeDemoData();
            
            // Test login for admin
            const email = 'admin@company.com';
            const password = 'Admin@123';
            
            console.log('Testing login for:', email);
            
            const demoUsers = JSON.parse(localStorage.getItem('demo_users') || '[]');
            console.log('Demo users loaded:', demoUsers.length);
            console.log('Looking for email:', email);
            console.log('Available emails:', demoUsers.map(u => u.email));
            
            const demoUser = demoUsers.find(user => {
                const emailMatch = user.email === email;
                console.log(`Comparing "${user.email}" === "${email}":`, emailMatch);
                return emailMatch;
            });
            
            console.log('Demo user found:', demoUser ? 'YES' : 'NO');
            
            if (demoUser) {
                console.log('Found demo user:', JSON.stringify(demoUser, null, 2));
                
                if (demoUser.password === password) {
                    output.innerHTML = `
                        <h2>✅ Authentication Successful!</h2>
                        <p><strong>User:</strong> ${demoUser.username}</p>
                        <p><strong>Email:</strong> ${demoUser.email}</p>
                        <p><strong>Role:</strong> ${demoUser.role}</p>
                        <p><strong>Department:</strong> ${demoUser.department}</p>
                    `;
                } else {
                    output.innerHTML = `
                        <h2>❌ Invalid Password</h2>
                        <p>Expected: ${demoUser.password}</p>
                        <p>Provided: ${password}</p>
                    `;
                }
            } else {
                output.innerHTML = `
                    <h2>❌ User Not Found</h2>
                    <p>Email: ${email}</p>
                    <p>Available users:</p>
                    <ul>
                        ${demoUsers.map(u => `<li>${u.email}</li>`).join('')}
                    </ul>
                `;
            }
        }

        function clearStorage() {
            localStorage.removeItem('demo_users');
            document.getElementById('output').innerHTML = '<p>Storage cleared</p>';
            console.log('Storage cleared');
        }

        // Auto-initialize on page load
        window.onload = function() {
            initializeDemoData();
        };
    </script>
</body>
</html>